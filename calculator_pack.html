<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Finance Calculators & Games</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Free finance calculators, Snake game, Tetris, and stock market open countdowns.">
<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f4f4f4;
}
.container{
    display:flex;
    max-width:1300px;
    margin:auto;
    padding:15px;
    gap:20px;
}
.left{
    flex:1;
    min-width:320px;
}
.right{
    width:420px;
    display:flex;
    flex-direction:column;
    gap:15px;
}
.card{
    background:#fff;
    padding:15px;
    border-radius:8px;
    box-shadow:0 2px 8px rgba(0,0,0,.1);
}
label{display:block;margin-top:8px;}
input{
    width:100%;
    padding:6px;
    margin-top:3px;
}
.result{
    margin-top:10px;
    font-weight:bold;
}
.game-box{
    position:relative;
    cursor:pointer;
}
canvas{
    background:#111;
    border-radius:10px;
    display:block;
}
.score{
    position:absolute;
    top:6px;
    left:8px;
    color:#fff;
    font-weight:bold;
}
.overlay{
    position:absolute;
    inset:0;
    background:rgba(0,0,0,.65);
    color:#fff;
    display:none;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:22px;
}
.countdown{font-size:18px;margin-top:5px;}
</style>
</head>
<body>

<div class="container">

<div class="left">

<div class="card">
<b>1. Compound Interest</b>
<label>Initial (â‚¬)<input id="ci_i" type="number"></label>
<label>Monthly (â‚¬)<input id="ci_m" type="number"></label>
<label>Annual Return (%)<input id="ci_r" type="number"></label>
<label>Years<input id="ci_y" type="number"></label>
<button onclick="calcCI()">Calculate</button>
<div class="result" id="ci_o"></div>
</div>

<div class="card">
<b>2. Mortgage Calculator</b>
<label>Loan (â‚¬)<input id="mo_l" type="number"></label>
<label>Annual Rate (%)<input id="mo_r" type="number"></label>
<label>Years<input id="mo_y" type="number"></label>
<button onclick="calcMortgage()">Calculate</button>
<div class="result" id="mo_o"></div>
</div>

<div class="card">
<b>3. Savings Goal</b>
<label>Target (â‚¬)<input id="sg_t" type="number"></label>
<label>Current (â‚¬)<input id="sg_c" type="number"></label>
<label>Annual Return (%)<input id="sg_r" type="number"></label>
<label>Years<input id="sg_y" type="number"></label>
<button onclick="calcSavings()">Calculate</button>
<div class="result" id="sg_o"></div>
</div>

<div class="card">
<b>4. Retirement Withdrawals</b>
<label>Current Savings (â‚¬)<input id="rt_c" type="number"></label>
<label>Monthly Contribution (â‚¬)<input id="rt_m" type="number"></label>
<label>Annual Return (%)<input id="rt_r" type="number"></label>
<label>Years to Save<input id="rt_y" type="number"></label>
<label>Monthly Withdrawal (â‚¬)<input id="rt_w" type="number"></label>
<div class="result" id="rt_o"></div>
</div>

<div class="card">
<b>Market Opens In</b>
<div>ðŸ‡«ðŸ‡® Helsinki<div class="countdown" id="hel"></div></div>
<div>ðŸ‡ºðŸ‡¸ NYSE<div class="countdown" id="ny"></div></div>
</div>

</div>

<div class="right">

<div class="game-box" id="snakeBox">
<canvas id="snake" width="400" height="400"></canvas>
<div class="score" id="snakeScore">Coins: 0</div>
<div class="overlay" id="snakeOver">GAME OVER<br>Click to restart</div>
</div>

<div class="game-box" id="tetrisBox">
<canvas id="tetris" width="400" height="400"></canvas>
<div class="score" id="tetrisScore">Score: 0</div>
</div>

</div>
</div>

<script>
// ================= CALCULATORS =================
function calcCI(){
    let i=+ci_i.value,m=+ci_m.value,r=+ci_r.value/100/12,y=+ci_y.value;
    if(!i||!r||!y){ci_o.innerHTML="Fill required fields";return;}
    let t=i;
    for(let k=0;k<y*12;k++) t=t*(1+r)+m;
    ci_o.innerHTML=`Final: â‚¬${t.toFixed(0)}`;
}
function calcMortgage(){
    let p=+mo_l.value,r=+mo_r.value/100/12,n=+mo_y.value*12;
    if(!p||!r||!n){mo_o.innerHTML="Fill required fields";return;}
    let pay=p*r/(1-Math.pow(1+r,-n));
    mo_o.innerHTML=`Monthly: â‚¬${pay.toFixed(2)}`;
}
function calcSavings(){
    let t=+sg_t.value,c=+sg_c.value||0,r=+sg_r.value/100/12,n=+sg_y.value*12;
    if(!t||!r||!n){sg_o.innerHTML="Fill required fields";return;}
    let m=(t-c*Math.pow(1+r,n))*r/(Math.pow(1+r,n)-1);
    sg_o.innerHTML=`Monthly needed: â‚¬${m.toFixed(0)}`;
}
function updateRet(){
    let c=+rt_c.value||0,m=+rt_m.value||0,r=+rt_r.value/100,y=+rt_y.value,w=+rt_w.value||0;
    if(!r){rt_o.innerHTML="Enter return rate";return;}
    if(!w && y){
        let cap=c;
        for(let i=0;i<y*12;i++) cap=cap*(1+r/12)+m;
        w=(cap*r)/12; rt_w.value=w.toFixed(2);
    }
    if(!y && w){
        let cap=c,months=0;
        while((cap*r)/12<w && months<1200){
            cap=cap*(1+r/12)+m; months++;
        }
        rt_y.value=(months/12).toFixed(1);
    }
    rt_o.innerHTML=`Safe withdrawal â‰ˆ â‚¬${w.toFixed(2)}`;
}
["rt_c","rt_m","rt_r","rt_y","rt_w"].forEach(id=>window[id].addEventListener("input",updateRet));

// ================= MARKET COUNTDOWN =================
function nextOpen(h,m,off){
    let n=new Date(),u=n.getTime()+n.getTimezoneOffset()*60000,l=new Date(u+off*3600000);
    let o=new Date(l); o.setHours(h,m,0,0);
    if(l.getDay()==6)o.setDate(o.getDate()+2);
    if(l.getDay()==0)o.setDate(o.getDate()+1);
    if(l>=o)o.setDate(o.getDate()+1);
    return o-l;
}
setInterval(()=>{
    hel.textContent=new Date(nextOpen(10,0,2)).toISOString().substr(11,8);
    ny.textContent=new Date(nextOpen(9,30,-5)).toISOString().substr(11,8);
},1000);

// ================= SNAKE =================
const sc=snake.getContext("2d"), S=20;
let s=[],dir,coin,alive=false,snakeActive=false,coins=0;
function startSnake(){
    s=[{x:200,y:200}];dir={x:S,y:0};
    coin={x:Math.floor(Math.random()*20)*S,y:Math.floor(Math.random()*20)*S};
    coins=0;snakeScore.textContent="Coins: 0";
    snakeOver.style.display="none";alive=true;snakeActive=true;
}
function drawSnake(){
    sc.fillStyle="#111";sc.fillRect(0,0,400,400);
    sc.fillStyle="gold";sc.beginPath();sc.arc(coin.x+10,coin.y+10,8,0,Math.PI*2);sc.fill();
    sc.fillStyle="#00ff99";s.forEach(p=>sc.fillRect(p.x+2,p.y+2,16,16));
}
function loopSnake(){
    if(!alive||!snakeActive)return;
    let h={x:s[0].x+dir.x,y:s[0].y+dir.y};
    if(h.x<0||h.y<0||h.x>=400||h.y>=400)return endSnake();
    if(s.some(p=>p.x==h.x&&p.y==h.y))return endSnake();
    s.unshift(h);
    if(h.x==coin.x&&h.y==coin.y){
        coins++;snakeScore.textContent="Coins: "+coins;
        coin={x:Math.floor(Math.random()*20)*S,y:Math.floor(Math.random()*20)*S};
    }else s.pop();
    drawSnake();
}
function endSnake(){alive=false;snakeOver.style.display="flex";}
setInterval(loopSnake,150);
snakeBox.onclick=startSnake;

// ================= TETRIS (FIXED CONTROLS) =================
const tc=tetris.getContext("2d"), COL=10, ROW=20, TS=20;
let grid=Array.from({length:ROW},()=>Array(COL).fill(0));
let piece=null,tActive=false,score=0;
const shapes=[
[[1,1,1,1]],
[[1,1],[1,1]],
[[0,1,0],[1,1,1]]
];
function newPiece(){
    let s=shapes[Math.floor(Math.random()*shapes.length)];
    piece={x:4,y:0,s:s};
}
function drawTetris(){
    tc.fillStyle="#111";tc.fillRect(0,0,400,400);
    tc.fillStyle="cyan";
    grid.forEach((r,y)=>r.forEach((c,x)=>{if(c)tc.fillRect(x*TS,y*TS,TS,TS);}));
    if(piece)piece.s.forEach((r,y)=>r.forEach((c,x)=>{if(c)tc.fillRect((piece.x+x)*TS,(piece.y+y)*TS,TS,TS);}));
}
function collide(px,py,ps){
    return ps.some((r,y)=>r.some((c,x)=>c&&(px+x<0||px+x>=COL||py+y>=ROW||grid[py+y][px+x])));
}
function drop(){
    if(!tActive||!piece)return;
    piece.y++;
    if(collide(piece.x,piece.y,piece.s)){
        piece.y--;
        piece.s.forEach((r,y)=>r.forEach((c,x)=>{if(c)grid[piece.y+y][piece.x+x]=1;}));
        newPiece();
    }
    drawTetris();
}
function rotate(){
    let r=piece.s[0].map((_,i)=>piece.s.map(row=>row[i]).reverse());
    if(!collide(piece.x,piece.y,r))piece.s=r;
}
setInterval(drop,800);
tetrisBox.onclick=()=>{tActive=true;if(!piece)newPiece();};
document.addEventListener("keydown",e=>{
    if(!(snakeActive||tActive))return;
    if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key))e.preventDefault();
    if(tActive&&piece){
        if(e.key=="ArrowLeft"&&!collide(piece.x-1,piece.y,piece.s))piece.x--;
        if(e.key=="ArrowRight"&&!collide(piece.x+1,piece.y,piece.s))piece.x++;
        if(e.key=="ArrowDown")drop();
        if(e.key=="ArrowUp")rotate();
        drawTetris();
    }
});
</script>
</body>
</html>
